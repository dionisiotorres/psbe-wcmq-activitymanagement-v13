<?xml version="1.0" encoding="utf-8"?>
<odoo>

<template id="registration_attendee_details" inherit_id="website_event.registration_attendee_details">
    <xpath expr="//form" position="before">
        <t t-set="countries" t-value="request.env['res.country'].search([])"/>
        <t t-set="edu_partners" t-value="request.env['res.partner'].sudo().search([('is_company', '=', True), ('edu_validated', '=', 'True')])"/>
    </xpath>
    <xpath expr="//t[@t-foreach='tickets']//div[hasclass('modal-body')]" position="replace">
        <div class="modal-body bg-light border-bottom">
            <h5 class="mt-1 pb-2 border-bottom">
                Ticket #<span t-esc="counter"/> <small class="text-muted">- <span t-esc="ticket['name']"/></small>
            </h5>

            <input type="hidden" t-attf-name="#{counter}-ticket_id" t-att-value="ticket['id']"/>

            <div class="row">
                <div class="col-lg my-2">
                    <label>Fistname</label>
                    <input type="text" t-attf-name="#{counter}-firstname" required="This field is required"
                        class="form-control"
                    />
                </div>
                <div class="col-lg my-2">
                    <label>Lastname</label>
                    <input type="text" t-attf-name="#{counter}-lastname" required="This field is required"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="row">
                <div class="col-lg my-2">
                    <label>Email</label>
                    <input type="email" t-attf-name="#{counter}-email" required="This field is required"
                         class="form-control"
                    />
                </div>
                <div class="col-lg my-2">
                    <label>Mobile</label>
                    <input type="tel" t-attf-name="#{counter}-mobile" required="This field is required"
                        class="form-control"
                    />
                </div>
            </div>
            <div class="row">
                <div class="col-lg my-2">
                    <label>Gender</label>
                    <select t-attf-name="#{counter}-gender" required="This field is required"
                        class="form-control"
                    >
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="col-lg my-2">
                    <label>Nationality</label>
                    <select t-attf-name="#{counter}-birth_county_id" required="This field is required"
                        class="form-control"
                    >
                        <t t-foreach="countries" t-as="c">
                            <option t-att-value="c.id"><t t-esc="c.display_name"/></option>
                        </t>
                    </select>
                </div>
                <div class="col-lg my-2">
                    <label>Residency</label>
                    <select t-attf-name="#{counter}-residence_country_id" required="This field is required"
                        class="form-control"
                    >
                        <t t-foreach="countries" t-as="c">
                            <option t-att-value="c.id"><t t-esc="c.display_name"/></option>
                        </t>
                    </select>
                </div>
            </div>
            <div t-if="ticket['ticket_type'] in ['student', 'student_presenter']" class="row">
                <div class="col-lg my-2">
                    <label>Birthdate</label>
                    <input type="text" t-attf-id="birthdatePicker{{ counter }}" t-attf-name="#{counter}-birthdate" required="This field is required"
                        data-toggle="datetimepicker" t-attf-data-target="#birthdatePicker{{ counter }}"
                        class="form-control datetimepicker-input o_website_form_date"
                    />
                </div>
                <div class="col-lg my-2">
                    <label>School / University</label>
                    <select t-attf-name="#{counter}-edu_partner_id" required="This field is required"
                        class="form-control"
                    >
                        <t t-foreach="edu_partners" t-as="p">
                            <option t-att-value="p.id"><t t-esc="p.display_name"/></option>
                        </t>
                    </select>
                </div>
                <div class="col-lg my-2">
                    <label>Expected Graduation Year</label>
                    <select t-attf-name="#{counter}-expected_graduation_year" required="This field is required"
                        class="form-control"
                    >
                        <t t-set="cy" t-value="datetime.datetime.today().year"/>
                        <t t-foreach="range(cy, cy + 7)" t-as="y">
                            <option t-att-value="y"><t t-esc="y"/></option>
                        </t>
                    </select>
                </div>
                <div t-if="ticket['ticket_type'] == 'student_presenter'" class="col-lg my-2">
                    <label>Topic of the poster</label>
                    <input type="text" t-attf-name="#{counter}-poster_topic" required="This field is required"
                        class="form-control"
                    />
                </div>
            </div>
            <div t-if="ticket['ticket_type'] == 'school_representative'" class="row">
                <div class="col-lg my-2">
                    <label>School / University</label>
                    <select t-attf-name="#{counter}-edu_partner_id" required="This field is required"
                        class="form-control"
                    >
                        <t t-foreach="edu_partners" t-as="p">
                            <option t-att-value="p.id"><t t-esc="p.display_name"/></option>
                        </t>
                    </select>
                </div>
                <div class="col-lg my-2">
                    <label>Profession</label>
                    <input type="text" t-attf-name="#{counter}-profession" required="This field is required"
                        class="form-control"
                    />
                </div>
            </div>
            <div t-if="ticket['ticket_type'] == 'public'" class="row">
                <div class="col-lg my-2">
                    <label>Profession</label>
                    <input type="text" t-attf-name="#{counter}-profession" required="This field is required"
                        class="form-control"
                    />
                </div>
            </div>
        </div>
    </xpath>
</template>

</odoo>
